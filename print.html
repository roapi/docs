<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ROAPI Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-4GB4QQGXTJ"></script>
        <script>
            var localAddrs = ["localhost", "127.0.0.1", ""];
            // Make sure we don't activate Google Analytics if the developer is inspecting the book locally...
            if (localAddrs.indexOf(document.location.hostname) === -1) {
                window.dataLayer = window.dataLayer || [];
                function gtag() { dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-4GB4QQGXTJ');
            }
        </script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="open-in-gh.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ROAPI Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/roapi/docs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="roapi-documentation"><a class="header" href="#roapi-documentation">ROAPI Documentation</a></h1>
<p><a href="https://github.com/roapi/roapi"><img src="https://img.shields.io/badge/repo-github-blue" alt="Project repository" /></a></p>
<p><a href="https://github.com/roapi/roapi">ROAPI</a> automatically spins up read-only APIs
and query frontends for slowly moving datasets without requiring you to write a
single line of code. It builds on top of <a href="https://github.com/apache/arrow">Apache Arrow</a> and
<a href="https://github.com/apache/arrow-datafusion">Datafusion</a>. The
core of its design can be boiled down to the following:</p>
<ul>
<li>Query frontends to translate SQL, GraphQL and REST API queries into
Datafusion plans.</li>
<li>Datafusion for query plan execution.</li>
<li>Data layer to load datasets from a variety of sources and formats with
automatic schema inference.</li>
<li>Response encoding layer to serialize intermediate Arrow record batch into
various formats requested by client.</li>
</ul>
<p>Its pluggable query core design makes it possible for users to efficiently
perform join queries across a diverse set of datasources from simple
CSV/Parquet files in Data warehouses, to MySQL/Postgres, to SASS like Google
spreadsheet.</p>
<p>See below for a high level design diagram:</p>
<img alt="roapi-design-diagram" src="./images/roapi.png">
<blockquote>
<p>If you'd like to share feedback on how you're using ROAPI, please <a href="https://docs.google.com/forms/d/1M1s1scZX39UouuVF8WzIFQoSyeKX5dMVQgQMtYJKGZU">fill out this survey</a>. Thanks!</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<h2 id="pre-built-binary"><a class="header" href="#pre-built-binary">Pre-built binary</a></h2>
<p>Platform specific pre-built binaries for each release are hosted on our <a href="https://github.com/roapi/roapi/releases">Github
release page</a>.</p>
<p>You can download and install them with a single command using pip:</p>
<pre><code class="language-bash">pip install roapi
</code></pre>
<p>If you are using homebrew, you can also install using <code>brew</code> command:</p>
<pre><code class="language-bash">brew install roapi
# notice that the binary itself is still roapi-http
</code></pre>
<h2 id="docker"><a class="header" href="#docker">Docker</a></h2>
<p>Pre-built docker images are hosted at
<a href="https://github.com/orgs/roapi/packages/container/package/roapi">ghcr.io/roapi/roapi</a>.</p>
<h2 id="build-from-source"><a class="header" href="#build-from-source">Build from source</a></h2>
<p>You need to install <a href="https://rustup.rs/">Rust toolchain</a> if you haven't done so.</p>
<pre><code class="language-bash">cargo install --locked --git https://github.com/roapi/roapi --branch main --bins roapi
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/installation.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="quick-start"><a class="header" href="#quick-start">Quick start</a></h1>
<p>Spin up APIs for <code>test_data/uk_cities_with_headers.csv</code> and
<code>test_data/spacex-launches.json</code>:</p>
<pre><code class="language-bash">roapi \
    --table "uk_cities=test_data/uk_cities_with_headers.csv" \
    --table "test_data/spacex_launches.json"
</code></pre>
<p>Or using prebuilt docker image:</p>
<pre><code>docker run -t --rm -p 8080:8080 ghcr.io/roapi/roapi:latest --addr-http 0.0.0.0:8080 \
    --table "uk_cities=test_data/uk_cities_with_headers.csv" \
    --table "test_data/spacex_launches.json"
</code></pre>
<h2 id="query-api"><a class="header" href="#query-api">Query API</a></h2>
<p>Query tables using SQL, GraphQL or REST:</p>
<pre><code class="language-bash">curl -X POST -d "SELECT city, lat, lng FROM uk_cities LIMIT 2" localhost:8080/api/sql
curl -X POST -d "query { uk_cities(limit: 2) {city, lat, lng} }" localhost:8080/api/graphql
curl "localhost:8080/api/tables/uk_cities?columns=city,lat,lng&amp;limit=2"
</code></pre>
<p>Sample response:</p>
<pre><code class="language-json">[
  {
    "city": "Elgin, Scotland, the UK",
    "lat": 57.653484,
    "lng": -3.335724
  },
  {
    "city": "Stoke-on-Trent, Staffordshire, the UK",
    "lat": 53.002666,
    "lng": -2.179404
  }
]
</code></pre>
<p>See <a href="api/query">Query frontends</a> for details on different operators supported
by each frontend.</p>
<h2 id="schema-api"><a class="header" href="#schema-api">Schema API</a></h2>
<p>Get inferred schema for all tables:</p>
<pre><code class="language-bash">curl localhost:8080/api/schema
</code></pre>
<p>Sample response:</p>
<pre><code class="language-json">{
  "uk_cities": {
    "fields": [
      {
        "name": "city",
        "data_type": "Utf8",
        "nullable": false,
        "dict_id": 0,
        "dict_is_ordered": false
      },
      {
        "name": "lat",
        "data_type": "Float64",
        "nullable": false,
        "dict_id": 0,
        "dict_is_ordered": false
      },
      {
        "name": "lng",
        "data_type": "Float64",
        "nullable": false,
        "dict_id": 0,
        "dict_is_ordered": false
      }
    ]
  }
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/quickstart.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="config"><a class="header" href="#config">Config</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="command-line-argument"><a class="header" href="#command-line-argument">Command line argument</a></h1>
<p>You can configure ROAPI to load as many tables as you want by repeating the <code>--table</code> argument:</p>
<pre><code>roapi --table 'table1_name=table1_uri' --table 'table2_name=table2_uri'
</code></pre>
<p>You can use <code>RUST_LOG</code> environment variable to control the logging verbosity:</p>
<pre><code>RUST_LOG=debug roapi ...
</code></pre>
<p>Here is the output from <code>roapi --help</code>:</p>
<pre><code>roapi 0.7.1
QP Hou
Create full-fledged APIs for static datasets without writing a single line of code.

USAGE:
    roapi [OPTIONS]

OPTIONS:
    -a, --addr-http &lt;IP:PORT&gt;
            HTTP endpoint bind address

    -c, --config &lt;config&gt;
            config file path

    -d, --disable-read-only
            Start roapi in read write mode

    -h, --help
            Print help information

    -p, --addr-postgres &lt;IP:PORT&gt;
            Postgres endpoint bind address

    -t, --table &lt;[table_name=]uri[,option_key=option_value]&gt;
            Table sources to load. Table option can be provided as optional setting as part of the
            table URI, for example: `blogs=s3://bucket/key,format=delta`. Set table uri to `stdin`
            if you want to consume table data from stdin as part of a UNIX pipe. If no table_name is
            provided, a table name will be derived from the filename in URI.

    -V, --version
            Print version information
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/cli.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="yaml-config"><a class="header" href="#yaml-config">YAML config</a></h1>
<h2 id="tables"><a class="header" href="#tables">Tables</a></h2>
<p>You can configure multiple table sources using YAML config, which supports more
advanced format specific table options. For example:</p>
<pre><code class="language-yaml">addr:
  # binding address for TCP port that speaks HTTP protocol
  http: 0.0.0.0:8080
  # binding address for TCP port that speaks Postgres wire protocol
  postgres: 0.0.0.0:5432
tables:
  - name: "blogs"
    uri: "test_data/blogs.parquet"

  - name: "ubuntu_ami"
    uri: "test_data/ubuntu-ami.json"
    option:
      format: "json"
      pointer: "/aaData"
      array_encoded: true
    schema:
      columns:
        - name: "zone"
          data_type: "Utf8"
        - name: "name"
          data_type: "Utf8"
        - name: "version"
          data_type: "Utf8"
        - name: "arch"
          data_type: "Utf8"
        - name: "instance_type"
          data_type: "Utf8"
        - name: "release"
          data_type: "Utf8"
        - name: "ami_id"
          data_type: "Utf8"
        - name: "aki_id"
          data_type: "Utf8"

  - name: "spacex_launches"
    uri: "https://api.spacexdata.com/v4/launches"
    option:
      format: "json"

  - name: "github_jobs"
    uri: "https://web.archive.org/web/20210507025928if_/https://jobs.github.com/positions.json"
</code></pre>
<h2 id="key-value-stores"><a class="header" href="#key-value-stores">Key value stores</a></h2>
<p>Table sources can be loaded into in-memory key value stores if you specify which two
columns to be used to load keys and values in the config:</p>
<pre><code class="language-yaml">kvstores:
  - name: "spacex_launch_name"
    uri: "test_data/spacex_launches.json"
    key: id
    value: name
</code></pre>
<p>The above config will create a keyvalue store named <code>spacex_launch_name</code> that allows you to lookup SpaceX launch names using launch ids.</p>
<h2 id="datafusion-configuration"><a class="header" href="#datafusion-configuration">DataFusion configuration</a></h2>
<p>You can override DataFusion configuration settings by specifying them in the <code>datafusion</code> section of your config file. This allows you to tune the query engine's behavior for your specific use case:</p>
<pre><code class="language-yaml">datafusion:
  "execution.collect_statistics": "true"
  "execution.batch_size": "8192"
  "sql_parser.enable_ident_normalization": "true"
</code></pre>
<p>The <code>datafusion</code> field accepts a map of configuration key-value pairs where both keys and values are strings. You can reference the <a href="https://docs.rs/datafusion/latest/datafusion/config/struct.ConfigOptions.html">DataFusion configuration documentation</a> for a complete list of available configuration options.</p>
<h2 id="specify-a-config-file-on-startup"><a class="header" href="#specify-a-config-file-on-startup">Specify a config file on startup</a></h2>
<p>Use <code>-c</code> argument to run ROAPI using a specific config file:</p>
<pre><code class="language-bash">roapi -c ./roapi.yml
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/config-file.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="dataset-formats"><a class="header" href="#dataset-formats">Dataset formats</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json"><a class="header" href="#json">JSON</a></h1>
<p>When a table uri ends in <code>.json</code>, ROAPI will try to load it as JSON table if no
<code>format</code> option is specified:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "http://mytable.json"
</code></pre>
<h2 id="filter-by-json-pointer"><a class="header" href="#filter-by-json-pointer">Filter by JSON pointer</a></h2>
<p>Sometimes the JSON array you want to serve might be stored inside a JSON
object. To support this use-case, ROAPI supports loading JSON using a <a href="https://tools.ietf.org/html/rfc6901">JSON
pointer</a>.</p>
<p>Take the following JSON data as an example:</p>
<pre><code class="language-json">{
    "x": {
        "y": [{"col1": "z"}, {"col1": "zz"}]
    }
}
</code></pre>
<p>In order to only serve <code>[{"col1": "z"}, {"col1": "zz"}]</code> through ROAPI, you can
configure the JSON table source as:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "http://mytable.json"
    option:
      format: "json"
      pointer: "/x/y"
</code></pre>
<h2 id="array-encoding"><a class="header" href="#array-encoding">Array encoding</a></h2>
<p>Each row in JSON data can be encoded using array for size reduction. This
convention allows us to avoid repeating column names in every row.</p>
<p>For example:</p>
<pre><code class="language-json">[
    {"col1": 1, "col2": "abc"},
    {"col1": 2, "col2": "efg"}
]
</code></pre>
<p>Can be stored as:</p>
<pre><code class="language-json">[
    [1, "abc"],
    [2, "efg"]
]
</code></pre>
<p>However, when loading JSON rows using array encoding, you must explicitly specify
the schema, since there is no column name in the datasource anymore for ROAPI to
perform the schema inference.</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "http://mytable.json"
    option:
      format: "json"
      array_encoded: true
    schema:
      columns:
        - name: "col1"
          data_type: "Int64"
        - name: "col2"
          data_type: "Utf8"
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/dataset-formats/json.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="parquet"><a class="header" href="#parquet">Parquet</a></h1>
<p>When a table uri ends in <code>.parquet</code>, ROAPI will try to load it as Parquet table if no
<code>format</code> option is specified:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "http://mytable.parquet"
</code></pre>
<p>You can partition a Parquet dataset into multiple partitions and load all of them
into a single table by directory path:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "./table_dir"
    option:
      format: "parquet"
</code></pre>
<h2 id="large-datasets"><a class="header" href="#large-datasets">Large Datasets</a></h2>
<p>ROAPI loads the entire table into memory as the default behavior.  If your
table is large or you want to avoid loading all data during startup, you can
set an additional option <code>use_memory_table: false</code> (default: <code>true</code>). With that
configuration, ROAPI will not copy the data into memory, but instructs datafusion
to directly operate on the backing storage.</p>
<p>At the moment, this comes with the following limitations:</p>
<ol>
<li>no nested schema: <a href="https://github.com/apache/arrow-datafusion/issues/83">datafusion#83</a></li>
<li>missing support for cloud storage: <a href="https://github.com/apache/arrow-datafusion/issues/616">datafusion#616</a></li>
</ol>
<p>Example:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "./table_dir"
    option:
      format: "parquet"
      use_memory_table: false
</code></pre>
<p>Note that when providing <code>use_memory_table</code> option, it becomes necessary to
also specify the format.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/dataset-formats/parquet.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="csv"><a class="header" href="#csv">CSV</a></h1>
<p>When a table uri ends in <code>.csv</code>, ROAPI will try to load it as CSV table if no
<code>format</code> option is specified:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "http://mytable.csv"
</code></pre>
<p>You can partition a CSV dataset into multiple partitions and load all of them
into a single table by directory path:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "./table_dir"
    option:
      format: "csv"
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/dataset-formats/csv.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="google-spreadsheet"><a class="header" href="#google-spreadsheet">Google spreadsheet</a></h1>
<p>To serve a Google spreadsheet as API, you need to gather the following config values:</p>
<ul>
<li>Google spreadsheet URL, usually in the form of <code>https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}#gid={SHEET_ID}</code>.</li>
<li>(Optional) Google spreadsheet sheet title (bottom of the spreadsheet UI).
This is required if <code>SHEET_ID</code> is not specified in URL through <code>#gid</code>.</li>
<li>Google spreadsheet service account secret key.</li>
</ul>
<p>Here are the steps to configure the service account:</p>
<ol>
<li><a href="https://console.developers.google.com/apis/library/sheets.googleapis.com">Activate Google Sheets API</a> in the Google API Console.</li>
<li>Create a service account: <a href="https://console.developers.google.com/apis/api/sheets.googleapis.com/credentials">https://console.developers.google.com/apis/api/sheets.googleapis.com/credentials</a>.</li>
<li>Go into service account setting, click <code>ADD KEY</code> -&gt; <code>Create new key</code>. Then select JSON format
and save it somewhere safe as a file. <img src="config/dataset-formats/../../images/gsheet-add-key.png" alt="gsheet-add-key" /></li>
<li>Copy email address for your newly created service account, usually in the format of <code>{ACCOUNT_NAME}@{PROJECT_ID}.iam.gserviceaccount.com</code>. <img src="config/dataset-formats/../../images/gsheet-service-account-email.png" alt="gsheet-service-account-email" /></li>
<li>Open the Google spreadsheet that you want to serve, then share it with the newly created service
account using the service account email. <img src="config/dataset-formats/../../images/gsheet-share-service-account.png" alt="gsheet-share-service-account" /></li>
</ol>
<p>Now you can configure ROAPI to load the google spreadsheet into a table using:</p>
<pre><code class="language-yaml">tables:
  - name: "table_name"
    uri: "https://docs.google.com/spreadsheets/d/1-lc4oij04aXzFSRMwVBLjU76s-K0-s6UPc2biOvtuuU#gid=0"
    option:
      format: "google_spreadsheet"
      application_secret_path: "path/to/service_account_key.json"
      # sheet_title is optional if `#gid` is specified in uri
      sheet_title: "sheet_name_within_google_spreadsheet"
</code></pre>
<p>ROAPI only invokes Google Sheets API during the initial data load, subsequent
query requests are served using in memory data.</p>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<p>Here is what it looks like to serve <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vRodiBkE77d8Y7FLe2BwwNNqy0jc3oSrtsGRrWMXXyAgdl68LxKm_LS0qfMVXa-ioPDP-5jurzKUJ0N/pubhtml">this public google
spreadsheet</a>
with ROAPI.</p>
<p>Start server:</p>
<pre><code>$ roapi -c local.yaml
[2022-05-31T01:07:55Z INFO  roapi::context] loading `uri(https://docs.google.com/spreadsheets/d/1-lc4oij04aXzFSRMwVBLjU76s-K0-s6UPc2biOvtuuU#gid=0)` as table `properties`
[2022-05-31T01:07:56Z INFO  roapi::context] registered `uri(https://docs.google.com/spreadsheets/d/1-lc4oij04aXzFSRMwVBLjU76s-K0-s6UPc2biOvtuuU#gid=0)` as table `properties`
[2022-05-31T01:07:56Z INFO  roapi::startup] ðŸš€ Listening on 127.0.0.1:5432 for Postgres traffic...
[2022-05-31T01:07:56Z INFO  roapi::startup] ðŸš€ Listening on 127.0.0.1:8080 for HTTP traffic...
</code></pre>
<p>Query through <a href="config/dataset-formats/../../postgres.html">Postgres wire protocol</a>:</p>
<pre><code>$ psql -h 127.0.0.1
psql (12.10 (Ubuntu 12.10-0ubuntu0.20.04.1), server 13)
WARNING: psql major version 12, server major version 13.
         Some psql features might not work.
Type "help" for help.

houqp=&gt; select "Address", "Bed", "Bath", "Occupied" from properties;
     Address      | Bed | Bath | Occupied
------------------+-----+------+----------
 Bothell, WA      |   3 |    2 | f
 Lynnwood, WA     |   2 |    1 | f
 Kirkland, WA     |   4 |    2 | f
 Kent, WA         |   3 |    2 | f
 Mount Vernon, WA |   2 |    1 | f
 Seattle, WA      |   3 |    1 | f
 Seattle, WA      |   2 |    1 | f
 Shoreline, WA    |   1 |    1 | f
 Bellevue, WA     |   3 |    1 | f
 Renton, WA       |   4 |    2 | f
 Woodinville, WA  |   3 |    3 | f
 Kenmore, WA      |   4 |    3 | f
 Fremont, WA      |   5 |    3 | f
 Redmond, WA      |   2 |    2 | f
 Mill Creek, WA   |   3 |    3 | f
(15 rows)
</code></pre>
<p>Query with aggregation using <a href="config/dataset-formats/../../api/query/sql.html">HTTP SQL frontend</a>:</p>
<pre><code>$ curl -s -X POST localhost:8080/api/sql --data-binary @- &lt;&lt;EOF | jq
SELECT DISTINCT("Landlord"), COUNT("Address")
FROM properties
GROUP BY "Landlord"
EOF

[
  {
    "Landlord": "Carl",
    "COUNT(properties.Address)": 3
  },
  {
    "Landlord": "Roger",
    "COUNT(properties.Address)": 3
  },
  {
    "Landlord": "Mike",
    "COUNT(properties.Address)": 4
  },
  {
    "Landlord": "Sam",
    "COUNT(properties.Address)": 2
  },
  {
    "Landlord": "Daniel",
    "COUNT(properties.Address)": 3
  }
]
</code></pre>
<p>Query with filter using <a href="config/dataset-formats/../../api/query/graphql.html">HTTP GraphQL frontend</a>:</p>
<pre><code>$ curl -s -X POST localhost:8080/api/graphql --data-binary @- &lt;&lt;EOF | jq
query {
  properties(
    filter: {
      Bed: { gt: 3 }
      Bath: { gte: 3 }
    }
    sort: [
      { field: "Bed", order: "desc" }
    ]
  ) {
    Address
    Bed
    Bath
    Monthly_Rent
  }
}
EOF
[
  {
    "Address": "Fremont, WA",
    "Bed": 5,
    "Bath": 3,
    "Monthly_Rent": "$4,500"
  },
  {
    "Address": "Kenmore, WA",
    "Bed": 4,
    "Bath": 3,
    "Monthly_Rent": "$4,000"
  }
]
</code></pre>
<p>Note: when inferring table schema from Google spreadsheets, ROAPI automatically
replaces spaces in column names with <code>_</code>(underscore).</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/dataset-formats/gsheet.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="ndjson"><a class="header" href="#ndjson">NDJSON</a></h1>
<p><a href="http://ndjson.org/">NDJSON</a> stands for Newline delimited JSON. It is a
convenient format for storing or streaming structured data that may be
processed one record at a time.</p>
<p>When a table uri ends in <code>.ndjson</code>, ROAPI will try to load it as NDJSON table
if no <code>format</code> option is specified:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "http://mytable.ndjson"
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/dataset-formats/ndjson.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="delta-lake"><a class="header" href="#delta-lake">Delta Lake</a></h1>
<p>ROAPI supports loading Delta tables from <a href="https://delta.io/">Delta Lake</a>
through <a href="https://github.com/delta-io/delta-rs">delta-rs</a>. Since a Delta table
doesn't have an extension suffix, ROAPI cannot infer table format from table
URI alone.  Therefore, the <code>format</code> option needs to be set to <code>delta</code>
explicitly for Delta table sources:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "s3://bucket/delta_table/path"
    option:
      format: "delta"
</code></pre>
<h2 id="large-datasets-1"><a class="header" href="#large-datasets-1">Large Datasets</a></h2>
<p>ROAPI loads the entire table into memory as the default behavior.  If your
table is large or you want to avoid loading all data during startup, you can
set an additional option <code>use_memory_table: false</code> (default: <code>true</code>). With that
configuration, ROAPI will not copy the data into memory, but instructs datafusion
to directly operate on the backing storage.</p>
<p>At the moment, this comes with the following limitations:</p>
<ol>
<li>no nested schema: <a href="https://github.com/apache/arrow-datafusion/issues/83">datafusion#83</a></li>
<li>missing support for cloud storage: <a href="https://github.com/apache/arrow-datafusion/issues/616">datafusion#616</a></li>
</ol>
<p>Example:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "./path/to/delta_table"
    option:
      format: "delta"
      use_memory_table: false
</code></pre>
<p>Note that when providing <code>use_memory_table</code> option, it becomes necessary to
also specify the format.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/dataset-formats/delta.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="arrow"><a class="header" href="#arrow">Arrow</a></h1>
<p>When a table uri ends in <code>.arrow</code> or <code>.arrows</code>, ROAPI will try to load it as
Arrow IPC file or stream if no <code>format</code> option is specified:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "http://mytable.arrow" # or .arrows
</code></pre>
<p>You can partition an Arrow dataset into multiple partitions and load all of them
into a single table by directory path:</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "./table_dir"
    option:
      format: "arrow" # or arrows
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/dataset-formats/arrow.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="excel"><a class="header" href="#excel">Excel</a></h1>
<p>ROAPI supports loading Microsoft Excel compatible formats including xls, xlsx, xlsb, and ods files.</p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "path/to/file.xlsx"
    option:
      format: "xlsx"
      sheet_name: "Sheet1"
</code></pre>
<h2 id="supported-formats"><a class="header" href="#supported-formats">Supported Formats</a></h2>
<ul>
<li><strong>xls</strong> - Microsoft Excel 5.0/95 Workbook</li>
<li><strong>xlsx</strong> - Excel Workbook</li>
<li><strong>xlsb</strong> - Excel Binary Workbook</li>
<li><strong>ods</strong> - OpenDocument Spreadsheet</li>
</ul>
<h2 id="sheet-selection"><a class="header" href="#sheet-selection">Sheet Selection</a></h2>
<p>You can specify which sheet to load from the spreadsheet using the <code>sheet_name</code> option. By default, ROAPI will use the first sheet if no sheet name is specified.
<img src="config/dataset-formats/../../images/xlsx_sheet_name.png" alt="xlsx_sheet_name" /></p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "path/to/file.xlsx"
    option:
      format: "xlsx"
      sheet_name: "MyDataSheet"
</code></pre>
<h2 id="table-range-options"><a class="header" href="#table-range-options">Table Range Options</a></h2>
<p>You can specify a specific range of cells to load from the spreadsheet:
You can specify a specific range of cells to load from the spreadsheet:</p>
<ul>
<li><strong>rows_range_start</strong> - The first row of the table containing column names (default: 0)</li>
<li><strong>rows_range_end</strong> - The last row of the table (default: all rows)</li>
<li><strong>columns_range_start</strong> - The first column of the table (default: 0)</li>
<li><strong>columns_range_end</strong> - The last column of the table (default: all columns)</li>
</ul>
<p><img src="config/dataset-formats/../../images/spread_sheet_range.png" alt="spread_sheet_range" /></p>
<pre><code class="language-yaml">tables:
  - name: "mytable"
    uri: "path/to/file.xlsx"
    option:
      format: "xlsx"
      sheet_name: "Sheet1"
      rows_range_start: 1
      rows_range_end: 4
      columns_range_start: 1
      columns_range_end: 3
</code></pre>
<h2 id="schema-inference"><a class="header" href="#schema-inference">Schema Inference</a></h2>
<p>ROAPI can automatically infer the schema from your Excel data. The first row within the specified range is treated as column names, and ROAPI will analyze the remaining rows to determine data types.</p>
<p>You can control schema inference with the <code>schema_inference_lines</code> option, which specifies how many rows to analyze (including the header row). For example, <code>schema_inference_lines: 3</code> will use the first row for column names and analyze 2 additional rows for data types.</p>
<p>If a column contains mixed data types (like both integers and floats), ROAPI will default to the Utf8 (string) data type.</p>
<h2 id="explicit-schema-definition"><a class="header" href="#explicit-schema-definition">Explicit Schema Definition</a></h2>
<p>For better performance and predictable data types, you can define the schema explicitly in your configuration:</p>
<pre><code class="language-yaml">tables:
  - name: "excel_table"
    uri: "path/to/file.xlsx"
    option:
      format: "xlsx"
    schema:
      columns:
        - name: "int_column"
          data_type: "Int64"
          nullable: true
        - name: "string_column"
          data_type: "Utf8"
          nullable: true
        - name: "float_column"
          data_type: "Float64"
          nullable: true
        - name: "datetime_column"
          data_type: !Timestamp [Seconds, null]
          nullable: true
        - name: "duration_column"
          data_type: !Duration Second
          nullable: true
        - name: "date32_column"
          data_type: Date32
          nullable: true
        - name: "date64_column"
          data_type: Date64
          nullable: true
        - name: "null_column"
          data_type: Null
          nullable: true
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/dataset-formats/excel.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="blob-store"><a class="header" href="#blob-store">Blob store</a></h1>
<p>ROAPI currently supports the following blob storages:</p>
<ul>
<li>Filesystem</li>
<li>HTTP/HTTPS</li>
<li>S3</li>
<li>GCS</li>
<li>Azure Storage</li>
</ul>
<h2 id="filesystem"><a class="header" href="#filesystem">Filesystem</a></h2>
<p>Filesystem store can be specified using <code>file:</code> or <code>filesystem:</code> schemes.  In a
Windows environment, the scheme is mandatory.  On Unix systems, a uri without a
scheme prefix is treated as filesystem backed data source by ROAPI.</p>
<p>For example, to serve a local parquet file <code>test_data/blogs.parquet</code>, you can
just set the uri to the file path:</p>
<pre><code class="language-yaml">tables:
  - name: "blogs"
    uri: "test_data/blogs.parquet"
</code></pre>
<p>Filesystem store supports loading partitioned tables. In other words, you can
split up the table into mulitple files and load all of them into a single table
by setting uri to the directory path. When loading a partitioned dataset, you
will need to manually specify table format since the uri will not contain table
format as a suffix:</p>
<pre><code class="language-yaml">tables:
  - name: "blogs"
    uri: "test_data/blogs/"
    option:
        format: "parquet"
</code></pre>
<h2 id="httphttps"><a class="header" href="#httphttps">HTTP/HTTPS</a></h2>
<p>ROAPI can build tables from datasets served through HTTP protocols. However, one
thing to keep in mind is HTTP store doesn't support partitioned datasets because
there is no native directory listing support in the HTTP protocol.</p>
<p>To set custom headers for HTTP requests, you can use the <code>headers</code> io option:</p>
<pre><code class="language-yaml">tables:
  - name: "TABLE_NAME"
    uri: "http://BUCKET/TABLE/KEY.csv"
    io_option:
      headers:
        'Content-Type': 'application/json'
        Authorization: 'Bearer TOKEN'
</code></pre>
<h2 id="s3"><a class="header" href="#s3">S3</a></h2>
<p>ROAPI can build tables from datasets hosted in S3 buckets. Configuration is
similar to filesystem store:</p>
<pre><code class="language-yaml">tables:
  - name: "TABLE_NAME"
    uri: "s3://BUCKET/TABLE/KEY"
    option:
        format: "csv"
</code></pre>
<p>To configure S3 credentials, you can set the following environment variables:</p>
<ul>
<li><code>AWS_ENDPOINT_URL</code>: The endpoint URL for your S3 provider</li>
<li><code>AWS_REGION</code>: The region where your S3 bucket is located</li>
<li><code>AWS_SECRET_ACCESS_KEY</code>: The secret access key from your S3 provider</li>
<li><code>AWS_ACCESS_KEY_ID</code>: The access key ID from your S3 provider</li>
</ul>
<h2 id="gcs"><a class="header" href="#gcs">GCS</a></h2>
<p>ROAPI can build tables from datasets hosted in GCS buckets. Configuration is
similar to filesystem store:</p>
<pre><code class="language-yaml">tables:
  - name: "TABLE_NAME"
    uri: "gs://BUCKET/TABLE/KEY"
    option:
        format: "csv"
</code></pre>
<p>To configure GCS credentials, you can set the following
environment variables if you are using service accont:</p>
<ul>
<li><code>GOOGLE_SERVICE_ACCOUNT</code> / <code>GOOGLE_SERVICE_ACCOUNT_PATH</code>: location of service account file</li>
<li><code>GOOGLE_SERVICE_ACCOUNT_KEY</code>: JSON serialized service account key</li>
<li><code>GOOGLE_APPLICATION_CREDENTIALS</code>: set by gcloud SDK</li>
<li><a href="https://cloud.google.com/compute/docs/access/service-accounts#associating_a_service_account_to_an_instance">Google Compute Engine Service Account</a></li>
<li><a href="https://cloud.google.com/kubernetes-engine/docs/concepts/workload-identity">GKE Workload Identity</a></li>
</ul>
<h2 id="azure-storage"><a class="header" href="#azure-storage">Azure Storage</a></h2>
<p>ROAPI can build tables from datasets hosted in Azure Storage. Configuration is
similar to filesystem store:</p>
<pre><code class="language-yaml">tables:
  - name: "TABLE_NAME"
    uri: "az://BUCKET/TABLE/KEY"
    option:
        format: "csv"
</code></pre>
<p>The supported url schemas are</p>
<ul>
<li><code>abfs[s]://&lt;container&gt;/&lt;path&gt;</code></li>
<li><code>az://&lt;container&gt;/&lt;path&gt;</code></li>
<li><code>adl://&lt;container&gt;/&lt;path&gt;</code></li>
<li><code>azure://&lt;container&gt;/&lt;path&gt;</code></li>
</ul>
<p>To configure Azure credentials, you can set the following
environment variables:</p>
<ul>
<li><code>AZURE_STORAGE_ACCOUNT_NAME</code></li>
<li><code>AZURE_STORAGE_ACCOUNT_KEY</code></li>
<li><code>AZURE_STORAGE_CLIENT_ID</code></li>
<li><code>AZURE_STORAGE_TENANT_ID</code></li>
<li><code>AZURE_STORAGE_SAS_KEY</code></li>
<li><code>AZURE_STORAGE_TOKEN</code></li>
<li><code>AZURE_MSI_ENDPOINT</code> / <code>AZURE_IDENTITY_ENDPOINT</code>: Endpoint to request a imds managed identity token</li>
<li><code>AZURE_OBJECT_ID</code>: Object id for use with managed identity authentication</li>
<li><code>AZURE_MSI_RESOURCE_ID</code>: Msi resource id for use with managed identity authentication</li>
<li><code>AZURE_FEDERATED_TOKEN_FILE</code>: File containing token for Azure AD workload identity federation</li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/blob-store.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="databases"><a class="header" href="#databases">Databases</a></h1>
<p>Thanks to the <a href="https://github.com/sfu-db/connector-x">connector-x</a> Rust crate,
ROAPI is able to load tables from popular relational databases like MySQL,
PostgreSQL and SQLite.</p>
<pre><code class="language-yaml">tables:
  - name: "table_foo"
    uri: "mysql://username:password@localhost:3306/database"
  - name: "table_bar"
    uri: "mysql://username:password@localhost:3306/database"
  - name: "table_baz"
    uri: "sqlite://path/to/sqlitelite/file"
</code></pre>
<p>With this, you can now write a single SQL query to join tables between MySQL, SQLite and local CSV files!</p>
<p>By default, ROAPI will use the provided table name as the table name to extract
data from the database. If you want to expose a specific database table with a
different name, you can use the <code>option</code> field to specify the original table
name like below:</p>
<pre><code class="language-yaml">tables:
  - name: custom_table_name
    uri: "sqlite://path/to/sqlitelite/file"
    option:
      table: original_table_name
      format: sqlite
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/config/databases.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="postgres-wire-protocol"><a class="header" href="#postgres-wire-protocol">Postgres wire protocol</a></h1>
<p>ROAPI uses the <a href="https://github.com/returnString/convergence">convergence</a> Rust
crate to read and write Postgres wire protocol. This means you will be able to
query all tables loaded in ROAPI using any Postgres Clients as if ROAPI is a
real Postgres database!</p>
<p>By default, ROAPI listens for Postgres traffic on address <code>127.0.0.1:5432</code>, but
you can change it using the <code>--addr-postgres</code> command line argument or add the
following to your config file:</p>
<pre><code class="language-yaml">addr:
  # binding address for TCP port that speaks Postgres wire protocol
  postgres: 0.0.0.0:5432
</code></pre>
<p>Once ROAPI boots up, you can connect to it without authentication:</p>
<pre><code>$ psql -h 127.0.0.1
psql (12.10 (Ubuntu 12.10-0ubuntu0.20.04.1), server 13)
WARNING: psql major version 12, server major version 13.
         Some psql features might not work.
Type "help" for help.

houqp=&gt; select 1;
 Int64(1) 
----------
        1
(1 row)

houqp=&gt; 
</code></pre>
<p>See <a href="config/dataset-formats/gsheet.html#example">here</a> for an example on how you can query data stored in a Google spreadsheet using the <code>psql</code> Postgres client.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/postgres.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="http-api"><a class="header" href="#http-api">HTTP API</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="query-frontends"><a class="header" href="#query-frontends">Query frontends</a></h1>
<p>ROAPI exposes a diverse set of interfaces through the HTTP protocol.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql"><a class="header" href="#sql">SQL</a></h1>
<p>To query tables using a subset of standard SQL, send the query payload through
<code>POST</code> request to <code>/api/sql</code> endpoint. This is the only query interface that
supports table joins.</p>
<p>SQL query frontend is the more flexible and powerful compared to
<a href="api/query/rest.html">REST</a> and <a href="api/query/graphql.html">GraphQL</a>. It is the only query frontend
that supports table joins.</p>
<p>SQL frontend supports <code>[""]</code> operator for accessing struct fields and array
element. For example <code>struct_col["key1"]["key2"]</code> or <code>array_col[0]</code>.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/api/query/sql.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="rest"><a class="header" href="#rest">REST</a></h1>
<p>Query tables through REST API by sending <code>GET</code> requests to
<code>/api/tables/{table_name}</code>. Query operators are specified as query params.</p>
<p>REST query frontend currently supports the following query operators:</p>
<ul>
<li>columns</li>
<li>sort</li>
<li>limit</li>
<li>filter</li>
</ul>
<p>To sort column <code>col1</code> in ascending order and <code>col2</code> in descending order, set
query param to: <code>sort=col1,-col2</code>.</p>
<p>To find all rows with <code>col1</code> equal to string <code>'foo'</code>, set query param to:
<code>filter[col1]='foo'</code>. You can also do basic comparisons with filters, for
example predicate <code>0 &lt;= col2 &lt; 5</code> can be expressed as
<code>filter[col2]gte=0&amp;filter[col2]lt=5</code>.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/api/query/rest.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="graphql"><a class="header" href="#graphql">GraphQL</a></h1>
<p>To query tables through GraphQL, send the query through <code>POST</code> request to
<code>/api/graphql</code> endpoint.</p>
<p>GraphQL query frontend supports the same set of operators supported by <a href="api/query/rest.html">REST
query frontend</a>. Here how is you can apply various operators in a query:</p>
<pre><code class="language-graphql">{
    table_name(
        filter: {
            col1: false
            col2: { gteq: 4, lt: 1000 }
        }
        sort: [
            { field: "col2", order: "desc" }
            { field: "col3" }
        ]
        limit: 100
    ) {
        col1
        col2
        col3
    }
}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/api/query/graphql.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="key-value-lookup"><a class="header" href="#key-value-lookup">Key value lookup</a></h1>
<p>Query key value stores through REST API by sending <code>GET</code> requests to
<code>/api/kv/{kv_name}/{key}</code>.</p>
<p>For example, the kvstore defined in <a href="api/query//config/config-file.html#key-value-stores">the sample
config</a> can be queried like below:</p>
<pre><code class="language-bash">$ curl -v localhost:8080/api/kv/spacex_launch_name/600f9a8d8f798e2a4d5f979e
Starlink-21 (v1.0)%
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/api/query/kv.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="schema"><a class="header" href="#schema">Schema</a></h1>
<p>Get schemas for all tables:</p>
<pre><code class="language-bash">curl localhost:8080/api/schema
</code></pre>
<p>Get schema for a specific table by name:</p>
<pre><code class="language-bash">curl localhost:8080/api/schema/{TABLE_NAME}
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/api/schema.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="response-serialization"><a class="header" href="#response-serialization">Response serialization</a></h1>
<p>By default, ROAPI encodes responses in JSON format, but you can request
different encodings by specifying the <code>ACCEPT</code> header:</p>
<pre><code class="language-bash">curl -X POST \
    -H 'ACCEPT: application/vnd.apache.arrow.stream' \
    -d "SELECT launch_library_id FROM spacex_launches WHERE launch_library_id IS NOT NULL" \
    localhost:8080/api/sql
</code></pre>
<p>ROAPI currently supports the following serialization formats:</p>
<ul>
<li><code>application/json</code></li>
<li><code>application/csv</code></li>
<li><code>application/vnd.apache.arrow.file</code></li>
<li><code>application/vnd.apache.arrow.stream</code></li>
<li><code>application/parquet</code></li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/roapi/docs/edit/main/src/api/response.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
